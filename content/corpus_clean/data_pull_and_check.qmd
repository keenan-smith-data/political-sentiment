---
title: "Data Check"
author: "Keenan Smith"
---

```{r}
here::i_am("content/corpus_clean/data_pull_and_check.qmd")
# source(here::here("R", "viable_links_original.R"))
library(DBI)
library(tidytable)
```

```{r}
#| label: Connecting the DB
pol_sent_db <- dbConnect(duckdb::duckdb(), dbdir = here::here("data","political-sentiment.duckdb"))
```

```{r}
DBI::dbExecute(pol_sent_db, "EXPORT DATABASE 'C:/Users/slaps/OneDrive/Documents/Programming/political-sentiment/data' (FORMAT PARQUET)")
```


```{r}
dbListTables(pol_sent_db)
```

```{r}
source(here::here("R", "text_sql_statements.R"))
source(here::here("R", "scraping_helpers.R"))
source(here::here("R", "article_pull_html.R"))
source(here::here("R", "write_to_db.R"))
```

```{r}
test <- article_pull_try_html(filtered_disc[40])
```

# Need to create Tables First prior to runnigng scripts

```{r}
table_create <- create_art_table("text_aei", pol_sent_db)
DBI::dbExecute(pol_sent_db, table_create)
```


```{r}
check_osf <- dbGetQuery(pol_sent_db, "SELECT * FROM text_osf")
check_gutt <- dbGetQuery(pol_sent_db, "SELECT * FROM text_gutt")
check_disc <- dbGetQuery(pol_sent_db, "SELECT * FROM text_disc")
check_epi <- dbGetQuery(pol_sent_db, "SELECT * FROM text_epi")
check_merc <- dbGetQuery(pol_sent_db, "SELECT * FROM text_merc")
check_urban <- dbGetQuery(pol_sent_db, "SELECT * FROM text_urban")
check_am <- dbGetQuery(pol_sent_db, "SELECT * FROM text_am")
check_comf <- dbGetQuery(pol_sent_db, "SELECT * FROM text_comf")
check_cbpp <- dbGetQuery(pol_sent_db, "SELECT * FROM text_cbpp")
```

```{r}
check_cbpp |>
  slice_tail()

nrow(check_cbpp)
```




```{r}
# Disconnecting from DuckDB
DBI::dbDisconnect(pol_sent_db, shutdown = TRUE)
```

